#!/bin/bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
SCRIPT_DIR="$DIR/bibtex2html-1.99-linux"
BIB_DIR="$DIR/../bib"

$SCRIPT_DIR/bibtex2html --no-abstract --no-keywords --nodoc --nobibsource -nodoi -noeprint --no-keys -linebreak -d -r \
    -nf url ' <i class="fa fa-file-pdf"></i> PDF ' -nf webpage ' <i class="fa fa-link"></i> Website ' \
    -nf video ' <i class="fa fa-play"></i> Video ' --output $BIB_DIR/progress-bib $BIB_DIR/progress.bib

# Remove the "generated by" message.
sed -i 's/<hr>.*$//' $BIB_DIR/progress-bib.html
sed -i '$ d' $BIB_DIR/progress-bib.html

# Remove the square brackets and pipes from links.
sed -i 's/^\[//' $BIB_DIR/progress-bib.html
sed -i 's/]$//' $BIB_DIR/progress-bib.html
sed -i 's/|\s*$//' $BIB_DIR/progress-bib.html
